# Running the No-Downtime Service Web UI

## Overview

The No-Downtime Service Web UI is built with Rust, WebAssembly, and the Yew framework. This document explains how to properly build and run the web UI to avoid common issues like SES (Secure ECMAScript) lockdown errors.

## Prerequisites

- Rust and Cargo installed
- wasm-pack installed (`cargo install wasm-pack`)
- Node.js (for the custom server, optional)

## Building the Web UI

1. Navigate to the web-ui directory:
   ```bash
   cd web-ui
   ```

2. Build the WebAssembly package:
   ```bash
   wasm-pack build --target web
   ```

   This will generate the compiled WASM files in the `pkg/` directory.

## Running the Web UI

### Option 1: Using the Custom Node.js Server (Recommended)

The custom Node.js server disables Content Security Policy headers that can cause SES lockdown issues:

1. Navigate to the web-ui directory:
   ```bash
   cd web-ui
   ```

2. Run the custom server:
   ```bash
   node server.js
   ```

3. Open your browser and navigate to:
   ```
   http://localhost:8081/
   ```

### Option 2: Using Python HTTP Server

If you prefer to use Python's built-in HTTP server:

1. Navigate to the web-ui directory:
   ```bash
   cd web-ui
   ```

2. Run the Python HTTP server:
   ```bash
   python -m http.server 8080
   ```

3. Open your browser and navigate to:
   ```
   http://localhost:8080/
   ```

   Note: You may encounter SES lockdown issues with this method. If you do, try the Node.js server instead.

## Troubleshooting

### SES Lockdown Errors

If you see errors like:
```
SES Removing unpermitted intrinsics lockdown-install.js
```

This indicates that a Content Security Policy or SES lockdown script is interfering with the WASM application. Use the custom Node.js server to avoid these issues.

### WASM Loading Issues

If the WASM module fails to load:

1. Ensure the `pkg/` directory contains the compiled files:
   - `no_downtime_web_ui.js`
   - `no_downtime_web_ui_bg.wasm`
   - `package.json`

2. Check the browser console for specific error messages.

3. Verify that the server is correctly serving files with the proper MIME types, especially for `.wasm` files.

## File Structure

```
web-ui/
├── pkg/                    # Compiled WASM output (generated by wasm-pack)
│   ├── no_downtime_web_ui.js      # JavaScript bindings
│   ├── no_downtime_web_ui_bg.wasm # WebAssembly binary
│   └── package.json               # Package metadata
├── src/                    # Rust source code
├── assets/                 # Static assets (CSS, images, etc.)
├── index.html              # Main HTML file
├── minimal.html            # Minimal test HTML file
├── server.js               # Custom Node.js server
└── Cargo.toml              # Rust package configuration
```

## Testing Different Pages

The web-ui directory contains several HTML files for testing:

- `index.html` - Original entry point
- `test.html` - Basic test page with error handling
- `simple.html` - Simplified test page
- `minimal.html` - Minimal page with custom loading UI

You can access these by navigating to:
- `http://localhost:8081/` (minimal.html)
- `http://localhost:8081/index.html`
- `http://localhost:8081/test.html`
- `http://localhost:8081/simple.html`

## Development Workflow

1. Make changes to the Rust source code in `src/`
2. Rebuild the WASM package:
   ```bash
   wasm-pack build --target web
   ```
3. Refresh the browser to see changes
4. For faster development, you can use `wasm-pack build --target web --dev` for unoptimized builds

## Browser Compatibility

The web UI works with modern browsers that support:
- WebAssembly
- ES6 modules
- Modern JavaScript features

Tested browsers:
- Chrome 70+
- Firefox 62+
- Safari 12+
- Edge 79+

## Security Considerations

When deploying to production:
1. Use proper Content Security Policy headers
2. Serve files over HTTPS
3. Consider using a production-grade web server (nginx, Apache, etc.)
4. Minify and compress assets for better performance